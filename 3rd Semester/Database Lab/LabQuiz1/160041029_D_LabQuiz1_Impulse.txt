160041029_D_LabQuiz1_Impulse



// page 1

// 1
ALTER TABLE EMP_NEW ADD DeptID Number;
ALTER TABLE EMP_NEW CONSTRAINTS FK_EMP_NEW_DeptID FOREIGN KEY (DeptID) REFERENCES department (ID);

// 2
SELECT USER_NAME CREATED FROM DBA_USERS ORDER BY CREATED;

// 3
ALTER TABLE TABLE_NAME MODIFY AGE NUMBER;

// 4
CREATE USER Shakleen_Ishfar IDENTIFIED BY dbms160041029;
GRANT CONNECT, CREATE SESSION, RESOURCE TO Shakleen_Ishfar;

// 5
CREATE TABLE Scientist
(
id number,
name varchar2(30),
totalpublications number,
age number,
nationality varchar2(30),
CONSTRAINTS PK_Scientist_id PRIMARY KEY (id)
);

CREATE TABLE Journal
(
paperID number,
title varchar2(50),
scientistID number,
year date,
CONSTRAINTS PK_Journal_paperID PRIMARY KEY (paperID),
CONSTRAINTS FK_Journal_scientistID FOREIGN KEY (scientistID) REFERENCES Scientist (id)
);

// 6
CREATE TABLE DEPARTMENT
(
CODE NUMBER,
NAME VARCHAR2(25),
BUDGET NUMBER,
CONSTRAINTS PK_DEPARTMENT_NUMBER PRIMARY KEY (CODE)
);

CREATE TABLE EMPLOYEES
(
SSN NUMBER,
NAME VARCHAR2(20),
LASTNAME VARCHAR2(20),
AGE NUMBER,
DEPARTMENT NUMBER,
CONSTRAINTS PK_EMPLOYEES_SSN PRIMARY KEY (SSN),
CONSTRAINTS FK_EMPLOYEES_DEPARTMENT FOREIGN KEY (DEPARTMENT) REFERENCES DEPARTMENT (CODE)
);

INSERT INTO DEPARTMENT
VALUES (14, 'IT', 65000);

INSERT INTO DEPARTMENT
VALUES (37, 'ACCOUNTING', 15000);

INSERT INTO DEPARTMENT
VALUES (59, 'HUMAN RESOURCE', 240000);

INSERT INTO DEPARTMENT
VALUES (77, 'RESERACH', 55000);


INSERT INTO EMPLOYEES
VALUES (1, 'Michael', 'Rogers', 37, 14);

INSERT INTO EMPLOYEES
VALUES (2, 'Anand', 'Manikutty', 51, 14);

INSERT INTO EMPLOYEES
VALUES (3, 'Carol', 'Smith', 35, 37);

INSERT INTO EMPLOYEES
VALUES (4, 'Joe', 'Stevens', 34, 37);

INSERT INTO EMPLOYEES
VALUES (5, 'Mary-Anne', 'Foster', 28, 14);

INSERT INTO EMPLOYEES
VALUES (6, 'George', 'ODonnell', 33, 77);

INSERT INTO EMPLOYEES
VALUES (7, 'John', 'Doe', 59, 59);

INSERT INTO EMPLOYEES
VALUES (8, 'David', 'Smith', 45, 77);

INSERT INTO EMPLOYEES
VALUES (9, 'Zacary', 'Efron', 20, 59);

INSERT INTO EMPLOYEES
VALUES (10, 'Eric', 'Goldsmith', 30, 59);

INSERT INTO EMPLOYEES
VALUES (11, 'Elizabeth', 'Doe', 22, 14);

INSERT INTO EMPLOYEES
VALUES (12, 'Kumar', 'Sawmy', 27, 14);




// page 2

// 1
SELECT NAME FROM DEPARTMENT WHERE BUDGET = (SELECT MAX(BUDGET) FROM DEPARTMENT);

// 2
SELECT NAME, LASTNAME FROM EMPLOYEES WHERE AGE = (SELECT MIN(AGE) FROM EMPLOYEES);

// 3
SELECT D.NAME, COUNT(E.SSN) 
FROM DEPARTMENT D, EMPLOYEES E
WHERE D.CODE = E.DEPARTMENT
GROUP BY D.NAME;

// 4
SELECT NAME, CODE
FROM DEPARTMENT
WHERE BUDGET <> (SELECT MIN(BUDGET) FROM DEPARTMENT);

// 5
SELECT * 
FROM EMPLOYEES
WHERE DEPARTMENT = 14 OR DEPARTMENT = 77;

// 6
SELECT COUNT (LASTNAME)
FROM EMPLOYEES
WHERE LASTNAME = 'Smith';

// 7
SELECT *
FROM DEPARTMENT
WHERE BUDGET > (SELECT AVG(BUDGET) FROM DEPARTMENT);

// 8
SELECT E.NAME, E.LASTNAME, D.NAME, D.BUDGET
FROM EMPLOYEES E, DEPARTMENT D
WHERE E.DEPARTMENT = D.CODE;

// 9
SELECT *
FROM DEPARTMENT
WHERE BUDGET > (SELECT MIN(BUDGET) FROM DEPARTMENT);

// 10
SELECT D.CODE, COUNT(E.SSN) 
FROM DEPARTMENT D, EMPLOYEES E
WHERE D.CODE = E.DEPARTMENT
GROUP BY D.CODE
HAVING COUNT(E.SSN) < 3;

// 11
SELECT SUM(BUDGET) FROM DEPARTMENT;

// 12
SELECT COUNT (DISTINCT (DEPARTMENT)) AS UNIQUE_DEPT
FROM EMPLOYEES;

// 13
SELECT  D.NAME AS DeptName
FROM DEPARTMENT D, EMPLOYEES E
WHERE D.CODE = E.DEPARTMENT
GROUP BY D.NAME, E.AGE
HAVING E.AGE < 36;

// 14
SELECT E.NAME, E.LASTNAME
FROM EMPLOYEES E, DEPARTMENT D
WHERE D.CODE = E.DEPARTMENT
GROUP BY D.BUDGET, E.NAME, E.LASTNAME
HAVING D.BUDGET > 60000;

// 15
SELECT D.NAME, AVG(E.AGE) AS AVERAGE_AGE
FROM EMPLOYEES E, DEPARTMENT D
WHERE D.CODE = E.DEPARTMENT
GROUP BY D.NAME;

// 16
SELECT DISTINCT (LASTNAME)
FROM EMPLOYEES;

// 17
SELECT BUDGET*1.2
FROM DEPARTMENT;

// 18
INSERT INTO DEPARTMENT
VALUES
(95, 'Quality Assurance', 40000);

// 19
UPDATE EMPLOYEES
SET DEPARTMENT = 95
WHERE DEPARTMENT = 77;

// 20
DELETE FROM EMPLOYEES
WHERE DEPARTMENT = 14;
