SQL> CREATE TABLE Planet
  2  (
  3  PlanetID INTEGER PRIMARY KEY,
  4  Name VARCHAR(255) NOT NULL,
  5  Coordinates REAL NOT NULL
  6  );

Table created.

SQL>
SQL> CREATE TABLE Client
  2  (
  3  AccountNumber INTEGER PRIMARY KEY,
  4  Name VARCHAR(255) NOT NULL
  5  );

Table created.

SQL>
SQL> CREATE TABLE Employee
  2  (
  3  EmployeeID INTEGER PRIMARY KEY,
  4  Name VARCHAR(255) NOT NULL,
  5  Position VARCHAR(255) NOT NULL,
  6  Salary REAL NOT NULL,
  7  Remarks VARCHAR(255)
  8  );

Table created.

SQL>
SQL> CREATE TABLE Shipment
  2  (
  3  ShipmentID INTEGER PRIMARY KEY,
  4  SDate DATE,
  5  Manager INTEGER NOT NULL,
  6  Planet INTEGER NOT NULL,
  7  FOREIGN KEY (Manager) REFERENCES Employee(EmployeeID),
  8  FOREIGN KEY (Planet) REFERENCES Planet(PlanetID)
  9  );

Table created.

SQL>
SQL> CREATE TABLE Has_Clearance
  2  (
  3  Employee INTEGER NOT NULL,
  4  Planet INTEGER NOT NULL,
  5  BLevel INTEGER NOT NULL,
  6  PRIMARY KEY(Employee, Planet),
  7  FOREIGN KEY (Employee) REFERENCES Employee(EmployeeID),
  8  FOREIGN KEY (Planet) REFERENCES Planet(PlanetID)
  9  );

Table created.

SQL> CREATE TABLE Package
  2  (
  3  Shipment INTEGER NOT NULL,
  4  PackageNumber INTEGER NOT NULL,
  5  Contents VARCHAR(255) NOT NULL,
  6  Weight REAL NOT NULL,
  7  Sender INTEGER NOT NULL,
  8  Recipient INTEGER NOT NULL,
  9  PRIMARY KEY(Shipment, PackageNumber),
 10  FOREIGN KEY (Shipment) REFERENCES Shipment(ShipmentID),
 11  FOREIGN KEY (Sender) REFERENCES Client(AccountNumber),
 12  FOREIGN KEY (Recipient) REFERENCES Client(AccountNumber)
 13  );

Table created.

SQL> INSERT INTO Planet VALUES(2, 'Decapod X', 65498463216.3466);

1 row created.

SQL> INSERT INTO Planet VALUES(3, 'Mars', 32435021.65468);

1 row created.

SQL> INSERT INTO Planet VALUES(4, 'Omega III', 98432121.5464);

1 row created.

SQL> INSERT INTO Planet VALUES(5, 'Tarantulon VI', 849842198.354654);

1 row created.

SQL> INSERT INTO Planet VALUES(6, 'Cannibalon', 654321987.21654);

1 row created.

SQL> INSERT INTO Planet VALUES(7, 'DogDoo VII', 65498721354.688);

1 row created.

SQL> INSERT INTO Planet VALUES(8, 'Nintenduu 64', 6543219894.1654);

1 row created.

SQL> INSERT INTO Planet VALUES(9, 'Amazonia', 65432135979.6547);

1 row created.

SQL> INSERT INTO Planet VALUES(1, 'Omicron Persei 8', 89475345.3545);

1 row created.

SQL>
SQL> INSERT INTO Client VALUES(1, 'Zapp Brannigan');

1 row created.

SQL> INSERT INTO Client VALUES(2, 'Al Gore''s Head');

1 row created.

SQL> INSERT INTO Client VALUES(3, 'Barbados Slim');

1 row created.

SQL> INSERT INTO Client VALUES(4, 'Ogden Wernstrom');

1 row created.

SQL> INSERT INTO Client VALUES(5, 'Leo Wong');

1 row created.

SQL> INSERT INTO Client VALUES(6, 'Lrrr');

1 row created.

SQL> INSERT INTO Client VALUES(7, 'John Zoidberg');

1 row created.

SQL> INSERT INTO Client VALUES(8, 'John Zoidfarb');

1 row created.

SQL> INSERT INTO Client VALUES(9, 'Morbo');

1 row created.

SQL> INSERT INTO Client VALUES(10, 'Judge John Whitey');

1 row created.

SQL> INSERT INTO Client VALUES(11, 'Calculon');

1 row created.

SQL> INSERT INTO Employee VALUES(1, 'Phillip J. Fry', 'Delivery boy', 7500.0, 'Not to be confused with the Philip J. Fry from Hovering Squid World 97a');

1 row created.

SQL> INSERT INTO Employee VALUES(2, 'Turanga Leela', 'Captain', 10000.0, NULL);

1 row created.

SQL> INSERT INTO Employee VALUES(3, 'Bender Bending Rodriguez', 'Robot', 7500.0, NULL);

1 row created.

SQL> INSERT INTO Employee VALUES(4, 'Hubert J. Farnsworth', 'CEO', 20000.0, NULL);

1 row created.

SQL> INSERT INTO Employee VALUES(5, 'John A. Zoidberg', 'Physician', 25.0, NULL);

1 row created.

SQL> INSERT INTO Employee VALUES(6, 'Amy Wong', 'Intern', 5000.0, NULL);

1 row created.

SQL> INSERT INTO Employee VALUES(7, 'Hermes Conrad', 'Bureaucrat', 10000.0, NULL);

1 row created.

SQL> INSERT INTO Employee VALUES(8, 'Scruffy Scruffington', 'Janitor', 5000.0, NULL);

1 row created.

SQL> INSERT INTO Shipment VALUES(1, DATE'3004-05-11', 1, 1);

1 row created.

SQL> INSERT INTO Shipment VALUES(2, DATE'3004-05-11', 1, 2);

1 row created.

SQL> INSERT INTO Shipment VALUES(3, NULL, 2, 3);

1 row created.

SQL> INSERT INTO Shipment VALUES(4, NULL, 2, 4);

1 row created.

SQL> INSERT INTO Shipment VALUES(5, NULL, 7, 5);

1 row created.

SQL> INSERT INTO Has_Clearance VALUES(1, 1, 2);

1 row created.

SQL> INSERT INTO Has_Clearance VALUES(1, 2, 3);

1 row created.

SQL> INSERT INTO Has_Clearance VALUES(2, 3, 2);

1 row created.

SQL> INSERT INTO Has_Clearance VALUES(2, 4, 4);

1 row created.

SQL> INSERT INTO Has_Clearance VALUES(3, 5, 2);

1 row created.

SQL> INSERT INTO Has_Clearance VALUES(3, 6, 4);

1 row created.

SQL> INSERT INTO Has_Clearance VALUES(4, 7, 1);

1 row created.

SQL> SQL> INSERT INTO Package VALUES(1, 1, 'Undeclared', 1.5, 1, 2);

1 row created.

SQL> INSERT INTO Package VALUES(2, 1, 'Undeclared', 10.0, 2, 3);

1 row created.

SQL> INSERT INTO Package VALUES(2, 2, 'A bucket of krill', 2.0, 8, 7);

1 row created.

SQL> INSERT INTO Package VALUES(3, 1, 'Undeclared', 15.0, 3, 4);

1 row created.

SQL> INSERT INTO Package VALUES(3, 2, 'Undeclared', 3.0, 5, 1);

1 row created.

SQL> INSERT INTO Package VALUES(3, 3, 'Undeclared', 7.0, 2, 3);

1 row created.

SQL> INSERT INTO Package VALUES(4, 1, 'Undeclared', 5.0, 4, 5);

1 row created.

SQL> INSERT INTO Package VALUES(4, 2, 'Undeclared', 27.0, 1, 2);

1 row created.

SQL> INSERT INTO Package VALUES(5, 1, 'Undeclared', 100.0, 5, 1);

1 row created.

SQL> SELECT Client.Name
  2  FROM Client, Package
  3  WHERE Client.AccountNumber = Package.Recipient AND Package.Weight = 1.5;

NAME
--------------------------------------------------------------------------------
Al Gore's Head

SQL> SELECT SUM(Package.Weight)
  2  FROM Package, Client
  3  WHERE Client.AccountNumber = Package.Recipient AND Client.Name = 'Al Gore''s Head';

SUM(PACKAGE.WEIGHT)
-------------------
               28.5

SQL> SQL> SELECT Employee.Name
  2  FROM
  3  (
  4  SELECT Shipment.Manager
  5  FROM
  6  (
  7  SELECT Package.Shipment
  8  FROM Package, Client
  9  WHERE Client.AccountNumber = Package.Recipient AND Client.Name = 'Al Gore''s Head'
 10  ) PackSent, Shipment
 11  WHERE PackSent.Shipment = Shipment.ShipmentID
 12  ) Pilot, Employee
 13  WHERE Pilot.Manager = Employee.EmployeeID;

NAME
--------------------------------------------------------------------------------
Phillip J. Fry
Turanga Leela

SQL>

